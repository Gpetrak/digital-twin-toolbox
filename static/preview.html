<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Preview | Docker 3D Tiles</title>
    <link rel="icon" href="img/logo.svg">
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.111/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.111/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/lil-gui@0.19"></script>
    <style>
        html,
        body,
        #container {
            position: absolute;
            padding: 0;
            margin: 0;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Courier New', Courier, monospace;
        }
    </style>
</head>

<body>
    <div id="container"></div>
    <script type="module">
        const viewer = new Cesium.Viewer('container', {
            baseLayerPicker: false,
            animation: false,
            fullscreenButton: false,
            geocoder: false,
            homeButton: false,
            infoBox: false,
            sceneModePicker: false,
            selectionIndicator: false,
            timeline: false,
            navigationHelpButton: false,
            navigationInstructionsInitiallyVisible: false,
            requestRenderMode: true,
            maximumRenderTimeChange: Infinity,
            skyBox: false
        });
        viewer.imageryLayers.removeAll();
        viewer.scene.globe.baseColor = new Cesium.Color(0.05, 0.05, 0.05, 1);
        viewer.scene.light = new Cesium.DirectionalLight({
            direction: viewer.scene.camera.directionWC,
        });
        Cesium.Cesium3DTileset.fromUrl(
            `/tilesets/${(window.location.search || 'missing-tileset').replace('?', '')}/tileset.json`
        ).then((tileset) => {
            viewer.scene.primitives.add(tileset);
            viewer.scene.globe.depthTestAgainstTerrain = false;
            viewer.zoomTo(tileset);
            const GUI = lil.GUI;
            const gui = new GUI();
            let controls = {
                debugShowBoundingVolume: false,
                debugShowGeometricError: false,
                debugShowRenderingStatistics: false,
                debugShowMemoryUsage: false
            };
            Object.keys(controls).forEach(key => {
                gui.add(controls, key).onChange((value) => {
                    tileset[key] = value;
                    viewer.scene.requestRender();
                });
            });
        })
        .catch((error) => {
            console.log(`Error loading tileset: ${error}`);
        })
    </script>
    </div>
</body>

</html>